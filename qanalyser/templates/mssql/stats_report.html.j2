<!DOCTYPE html>
<html lang="en">
<head>
<title>Qanalyser - Query Statistics Report for Microsoft SQL Server</title>
<meta charset="UTF-8"/>
<style>
    body {
        font-family: "Lucida Sans Unicode", "Lucida Grande", sans-serif;
        font-size: 16px;
        color: #b3b2b2;
        background-color: #1a1a1a;

    }
    a {
        color: #22cf96;
    }
    table {
        border-collapse: collapse;
        border-radius: 5px;
        width: 100%;
    }
    th {
        font-size: 13px;
        background-color: #353535;
    }
    td {
        font-size: 12px;
        border: 1px solid #353535;
        background-color: #2b2b2b;
    }
    th, td {
        color: #b1b1b1;
        padding: 4px;
    }
    th.special {
        color: #1fbe89;
        background-color: #4e4e4e;
        border: 10px solid #4e4e4e;
        padding: 0;
    }
    td.special {
        color: #1fbe89;
        background-color: #3a3a3a;
        border: 1px solid #17966c;
    }
    .query-output {
        font-size: 11px;
        font-family: "Lucida Console", Monaco, monospace;
    }
    .sql-query-table-cell {
        white-space: pre-wrap;
        word-break: break-all;
        width: 50%;
    }
    .new-page-before {
        page-break-before: always;
    }
    .new-page-after {
        page-break-after: always;
    }
    .center {
        text-align: center;
    }
</style>
</head>
<body>
    <h1>Qanalyser - Query Statistics Report for Microsoft SQL Server</h1>
    <h2>Information</h2>
    <table>
        <tr>
            <td>SQL Server instance</td>
            <td>{{ server }}</td>
        </tr>
        <tr>
            <td>Database</td>
            <td>{{ database }}</td>
        </tr>
        <tr>
            <td>Reported datetime</td>
            <td>{{ report_date }} at {{ report_time }}</td>

        </tr>
    </table>
    <h2>Report Summary</h2>
    <ul>
        {%- for query_result in queries_result %}
        <li>
            <a href="#{{ query_result.order_by_column_name | replace(' ', '-') }}">Top {{ top_limit }} queries by {{ query_result.order_by_column_name }}</a>
        </li>
        {%- endfor %}
    </ul>
    {%- for query_result in queries_result %}
    <table>
        <thead>
            <tr>
                <th colspan={{ query_result.columns|length + 1 }} class="special">
                    <a id="{{ query_result.order_by_column_name | replace(' ', '-') }}"></a>Top {{ top_limit }} queries by {{ query_result.order_by_column_name }}
                </th>
            </tr>
            <tr>
                <th>Rank</th>
                {%- for column in query_result.columns %}
                {%- if loop.index == query_result.order_by_column_index + 1 %}
                <th class="special">{{ query_result.order_by_column_name }}</th>
                {%- else %}
                <th>{{ column }}</th>
                {%- endif %}
                {%- endfor %}
            </tr>
        </thead>
        <tbody>
            {%- for row in query_result.rows %}
            <tr>
                <td class="center">{{ loop.index }}</td>
                {%- for data in row %}
                {%- if loop.index == 1 %}
                <td class="query-output sql-query-table-cell">
                {%- elif loop.index == query_result.order_by_column_index + 1 -%}
                <td class="query-output special">
                {%- else %}
                <td class="query-output">
                {%- endif %}
{{ data | replace('&', '&amp;') | replace('<', '&lt;') | replace('>', '&gt;') }}
                </td>
                {%- endfor %}
            </tr>
            {%- endfor %}
        </tbody>
    </table>
    {%- endfor %}
</body>
</html>
